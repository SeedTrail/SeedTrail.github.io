document.addEventListener('DOMContentLoaded', function() {
  const sliderContainer = document.querySelector('.slider-container');
  const eventDetails = document.getElementById('eventDetails');

  // Define your 14 events
  const events = [
    {
      name: "US Election 2016",
      date: "2016-11-08",
      image: "/assets/img/icon1.avif",
      description: "Together, the three analyses identify the 2012 US presidential election as a highly salient but transient event in YouTube activity. The strong DiD divergence, the ITS discontinuity, and the extreme placebo result consistently point to a short-lived surge in attention tied closely to the election date.",
      plotJson: "/assets/js/us_election_2016.json", // Plotly JSON for the first plot
      plotlyDescription: "I observe a clear and well-timed spike in the treated topic at the event date, standing out from the control category. Prior to the election, both series display similar cyclical behavior, suggesting that the parallel trends assumption is reasonably satisfied. The divergence at the event date is sharp but short-lived, with the treated series quickly reverting toward pre-event levels",
      plotPaths: [
        "/assets/plots/us_election_2016_ITS.png", // Static image for the second plot
        "/assets/plots/us_election_2016_Placebo.png"  // Static image for the third plot
      ],
      plotDescriptions: [
      "The ITS analysis shows a little pronounced level increase at the election date, followed by a sustained downward trend in the post-event period. This pattern is characteristic of an attention peak centered on election day, after which interest rapidly decays. There is no evidence of a persistent post-election elevation, indicating that the effect is primarily concentrated around the event itself.",
      "The placebo test places the estimated effect for the actual election date far in the extreme right tail of the distribution. Effects of comparable magnitude are virtually absent under random-date assignments, strongly suggesting that the observed spike is not attributable to background variability."
      ]
    },
    {
      name: "Brexit",
      date: "2016-06-23",
      image: "/assets/img/brexit.jpg",
      description: "Across all three analyses, Brexit stands out as a clear and well-identified shock in YouTube activity. The consistency between the DiD divergence, the ITS structural break, and the extremeness of the placebo estimate supports the interpretation of a genuine, event-driven impact. Unlike more gradual or anticipatory phenomena, Brexit appears in the data as a discrete moment that left a strong and traceable digital footprint.",
      plotJson: "/assets/js/brexit.json", // Plotly JSON for the first plot
      plotlyDescription: "I observe a pronounced and sharp spike in the treated topic at the event date, clearly exceeding the contemporaneous movement of the control category. Before the event, both series follow comparable cyclical patterns, supporting the parallel trends assumption. At the intervention point, the divergence is immediate and large, suggesting a strong short-term treatment effect associated with the Brexit referendum.",
      plotPaths: [
        "/assets/plots/brexit_ITS.png", // Static image for the second plot
        "/assets/plots/brexit_Placebo.png"  // Static image for the third plot
      ],
      plotDescriptions: [
      "The ITS analysis shows a clear structural break at the event date. I observe an abrupt level increase that interrupts the pre-existing upward trend, followed by a gradual decline in the post-event period. This pattern is consistent with a sudden surge in attention triggered by the event, rather than a continuation of prior dynamics. The magnitude and timing of the change provide strong visual evidence of an event-driven effect.", // Add placeholder if no description
      "The placebo test indicates that the estimated effect at the actual event date lies far in the right tail of the placebo distribution. Effects of similar magnitude are rarely generated by random dates, suggesting that the observed signal is unlikely to be due to chance alone. This strengthens the credibility of the detected effect."  // Add placeholder if no description
      ]
    },
    {
      name: "Paris Attacks",
      date: "2015-11-13",
      image: "/assets/img/paris.jpg",
      description: "Across all three analyses, the Paris attacks emerge as one of the clearest examples of a discrete attention shock in the dataset. The alignment of a dramatic DiD spike, a sharp ITS discontinuity, and an extreme placebo result provides strong and consistent evidence of an immediate but short-lived impact on YouTube activity, leaving a clear yet transient digital trace.",
      plotJson: "/assets/js/paris_attacks.json", // Plotly JSON for the first plot
      plotlyDescription: "I observe a very sharp and immediate spike in the treated topic at the event date, far exceeding the contemporaneous movement of the control category. Prior to the event, both series exhibit similar cyclical behavior, supporting the validity of the comparison. The magnitude and abruptness of the divergence point to a strong short-term reaction clearly associated with the attacks.",
      plotPaths: [
        "/assets/plots/paris_attacks_ITS.png", // Static image for the second plot
        "/assets/plots/paris_attacks_Placebo.png"  // Static image for the third plot
      ],
      plotDescriptions: [
      "The ITS analysis shows a pronounced level jump exactly at the event date, followed by a steep downward trend in the post-event period. This pattern is characteristic of a shock response: a sudden surge in attention that dissipates over time. There is no evidence of a sustained post-event elevation, suggesting that the effect is intense but transient.", // Add placeholder if no description
      "The placebo distribution indicates that the estimated effect at the true event date lies far in the extreme right tail, well outside the range typically generated by random dates. Such a large effect is highly unlikely to occur by chance, strongly reinforcing the interpretation of a genuine event-driven signal."  // Add placeholder if no description
      ]
    },
    {
      name: "Hong Kong Protests",
      date: "2019-08-12",
      image: "/assets/img/hong-kong.webp",
      description: "Taken together, the analyses suggest that the Hong Kong protests produced a noticeable but short-lived spike in YouTube activity. The signal is visible across DiD and ITS as a sharp peak, yet its moderate placement within the placebo distribution cautions against overinterpreting its strength. This event appears in the data as an intense moment of attention rather than a long-lasting structural change.",
      plotJson: "/assets/js/hong_kong_protests_peak.json", // Plotly JSON for the first plot
      plotlyDescription: "I observe that the treated topic closely follows the control category prior to the event, with strong cyclical patterns shared by both series. At the event date, there is a clear and sharp spike in the treated series that is not mirrored by the control, indicating a short-term divergence consistent with a peak in attention. However, this effect appears transient, as the series quickly re-aligns with the control afterward, suggesting a burst rather than a sustained shift.",
      plotPaths: [
        "/assets/plots/hong_kong_protests_peak_ITS.png", // Static image for the second plot
        "/assets/plots/hong_kong_protests_peak_Placebo.png"  // Static image for the third plot
      ],
      plotDescriptions: [
      "The ITS analysis reveals a distinct level increase at the event date, interrupting a relatively stable pre-event trend. This jump is followed by a gradual decline in the post-event period, consistent with a peak-and-decay dynamic. The timing and abruptness of the change point toward a genuine event-related surge in activity, though the absence of a lasting post-event elevation suggests the effect is concentrated around the peak.", // Add placeholder if no description
      "The placebo distribution shows that the estimated effect at the true event date lies toward the upper tail of the distribution but not in an extreme position. This indicates that while the observed effect is larger than most random-date effects, similar magnitudes can occasionally occur by chance. "  // Add placeholder if no description
      ]
    },
    {
      name: "US Election 2012",
      date: "2012-11-06",
      image: "/assets/img/2012.jpg",
      description: "Together, the three analyses identify the 2012 US presidential election as a highly salient but transient event in YouTube activity. The strong DiD divergence, the ITS discontinuity, and the extreme placebo result consistently point to a short-lived surge in attention tied closely to the election date.",
      plotJson: "/assets/js/us_election_2012.json", // Plotly JSON for the first plot
      plotlyDescription: "I observe a clear and well-timed spike in the treated topic at the event date, standing out from the control category. Prior to the election, both series display similar cyclical behavior, suggesting that the parallel trends assumption is reasonably satisfied. The divergence at the event date is sharp but short-lived, with the treated series quickly reverting toward pre-event levels.",
      plotPaths: [
        "/assets/plots/us_election_2012_ITS.png", // Static image for the second plot
        "/assets/plots/us_election_2012_Placebo.png"  // Static image for the third plot
      ],
      plotDescriptions: [
      "The ITS analysis shows a little pronounced level increase at the election date, followed by a sustained downward trend in the post-event period. This pattern is characteristic of an attention peak centered on election day, after which interest rapidly decays. There is no evidence of a persistent post-election elevation, indicating that the effect is primarily concentrated around the event itself.", // Add placeholder if no description
      "The placebo test places the estimated effect for the actual election date far in the extreme right tail of the distribution. Effects of comparable magnitude are virtually absent under random-date assignments, strongly suggesting that the observed spike is not attributable to background variability."  // Add placeholder if no description
      ]
    },
    {
      name: "#MeToo",
      date: "2017-10-01",
      image: "/assets/img/MeToo.jpg",
      description: "Taken together, the analyses point to #MeToo as a structurally transformative event in YouTube activity. The consistent post-event divergence in DiD, the sustained level and trend change in ITS, and the distinct placebo positioning all suggest a lasting shift in attention. Unlike short-lived peaks tied to discrete moments, #MeToo appears in the data as a durable reconfiguration of the platform’s thematic landscape, but not as a sharp peak event.",
      plotJson: "/assets/js/metoo.json", // Plotly JSON for the first plot
      plotlyDescription: "I observe that before the event date, the treated topic and the control category evolve in a broadly similar way, with shared cyclical patterns. After the event, the treated series shows a sustained upward shift relative to the control, rather than a single sharp spike. This divergence suggests a medium-term increase in attention associated with #MeToo, consistent with a movement that reshapes discourse over time rather than producing a one-day shock.",
      plotPaths: [
        "/assets/plots/metoo_ITS.png", // Static image for the second plot
        "/assets/plots/metoo_Placebo.png"  // Static image for the third plot
      ],
      plotDescriptions: [
      "The ITS analysis indicates a clear level change at the event date, followed by a steeper positive trend in the post-event period. Unlike events characterized by peak-and-decay dynamics, the post-intervention trajectory remains elevated and continues to grow. This pattern supports the interpretation of a structural change in attention rather than a transient response.", // Add placeholder if no description
      "The placebo distribution shows that the estimated effect at the true event date lies in the left tail of the distribution, outside the central mass of random-date effects. Such values are relatively rare under placebo assignments, suggesting that the observed change is unlikely to be explained by background variability alone."  // Add placeholder if no description
      ]
    },
    {
      name: "Black Lives Matter",
      date: "2013-07-13",
      image: "/assets/img/blm.png",
      description: "Taken together, the three analyses suggest that while Black Lives Matter–related content exhibits temporal variation, there is no robust or statistically distinctive impact detectable in this first-level analysis. Notably, the presence of several spikes before the event date in the ITS hints at an anticipatory build-up of attention, suggesting that the movement may have been gaining visibility prior to the identified event rather than being initiated by it.",
      plotJson: "/assets/js/black_lives_matter.json", // Plotly JSON for the first plot
      plotlyDescription: "I observe that the treated topic (Black Lives Matter) and the control category follow broadly similar temporal patterns before and after the event date. While there are short-lived spikes around mid-July, these fluctuations are not clearly distinguishable from the regular oscillations already present in both series. Overall, the DiD plot does not provide strong visual evidence of a sustained differential effect attributable to the event.",
      plotPaths: [
        "/assets/plots/black_lives_matter_ITS.png", // Static image for the second plot
        "/assets/plots/black_lives_matter_Placebo.png"  // Static image for the third plot
      ],
      plotDescriptions: [
      "From the ITS analysis, I note a gradual increase in activity leading up to the event date, followed by a visible decline afterward. The change appears smooth rather than abrupt, suggesting a continuation of an existing trend rather than a clear structural break. The event coincides with a local maximum, but the post-event decrease alone does not strongly support a causal interpretation.", // Add placeholder if no description
      "The placebo distribution shows that the estimated effect at the actual event date lies well within the range of effects obtained from random dates. This indicates that the observed signal is not exceptional relative to background variability. I therefore interpret this as weak evidence against the null, as similar effects frequently arise even in the absence of a true event."  // Add placeholder if no description
      ]
    },
    {
      name: "Pokémon GO",
      date: "2016-07-06",
      image: "/assets/img/pokemon.jpg",
      description: " Taken together, the analyses suggest that the Pokémon GO launch does not appear as a discrete attention shock in this dataset. Despite its real-world cultural impact, YouTube activity seems to have already been high and volatile in the surrounding period, absorbing the launch without producing a clearly identifiable breakpoint. This points to a case where massive offline popularity does not necessarily translate into a sharp, measurable disruption in aggregate platform-level signals.",
      plotJson: "/assets/js/pokemon_go.json", // Plotly JSON for the first plot
      plotlyDescription: " I observe that the treated topic and the control category track each other closely both before and after the launch date, with strong shared weekly oscillations. There is no clear or abrupt divergence at the event date: the treated series does not display a distinct spike relative to the control. This suggests that, at this temporal resolution, the launch does not register as a sharp deviation from broader gaming-related activity.",
      plotPaths: [
        "/assets/plots/pokemon_go_ITS.png", // Static image for the second plot
        "/assets/plots/pokemon_go_Placebo.png"  // Static image for the third plot
      ],
      plotDescriptions: [
      " The ITS analysis indicates a small level increase at the event date, followed by a largely flat post-event trajectory. The pre-event trend is already slightly increasing, and the launch appears to coincide with a modest stabilization rather than a dramatic shift. There is no clear structural break or pronounced change in slope, pointing to a smooth transition rather than an attention shock.", // Add placeholder if no description
      " In the placebo test, the estimated effect at the true event date lies close to the center of the placebo distribution. Effects of similar magnitude are common under random date assignments, indicating that the observed change is not statistically distinctive."  // Add placeholder if no description
      ]
    },
    {
      name: "E3 2016",
      date: "2016-06-14",
      image: "/assets/img/e3.webp",
      description: " Across all three analyses, E3 appears as a textbook example of a predictable, event-driven attention shock. The alignment of a sharp DiD spike, a clear ITS discontinuity, and an extreme placebo result confirms that E3 leaves a strong but ephemeral digital footprint.Intense visibility concentrated around the event window, followed by a rapid return to normal levels.",
      plotJson: "/assets/js/e3.json", // Plotly JSON for the first plot
      plotlyDescription: " I observe a very sharp and isolated spike in the treated topic exactly at the event date, clearly separating it from both the control category and the surrounding periods. Before and after the event, the treated and control series follow similar cyclical patterns, with no sustained divergence. This indicates a strong but highly localized treatment effect concentrated at the time of E3.",
      plotPaths: [
        "/assets/plots/e3_ITS.png", // Static image for the second plot
        "/assets/plots/e3_Placebo.png"  // Static image for the third plot
      ],
      plotDescriptions: [
      " The ITS analysis shows a pronounced level jump at the event date, interrupting a moderately increasing pre-event trend. Immediately after the peak, the series returns toward baseline levels, followed by a mild downward trend. This pattern is characteristic of a scheduled media event that generates intense but short-lived attention rather than a lasting shift in interest.", // Add placeholder if no description
      "The placebo test places the estimated effect of the actual event far in the extreme right tail of the distribution. Effects of comparable magnitude are not observed under random date assignments, suggesting that the spike is highly unlikely to be driven by chance alone."  // Add placeholder if no description
      ]
    },
    {
      name: "FIFA 17 Launch",
      date: "2016-09-27",
      image: "/assets/img/fifa.webp",
      description: " Taken together, the analyses suggest that the FIFA 17 launch is characterized by gradual buildup and normalization rather than a sharp event-driven shock. Attention appears to be absorbed smoothly into ongoing platform dynamics, reflecting the predictable and highly anticipated nature of major game releases rather than a disruptive moment in YouTube activity.",
      plotJson: "/assets/js/fifa_17_launch.json", // Plotly JSON for the first plot
      plotlyDescription: " I observe that the treated topic and the control category follow very similar trajectories both before and after the release date, with strong shared seasonal oscillations. There is no sharp divergence at the event date: the treated series does not exhibit a distinct spike or sustained shift relative to the control. This suggests that the launch does not stand out as a discrete attention shock when compared to overall gaming-related activity.",
      plotPaths: [
        "/assets/plots/fifa_17_launch_ITS.png", // Static image for the second plot
        "/assets/plots/fifa_17_launch_Placebo.png"  // Static image for the third plot
      ],
      plotDescriptions: [
      " The ITS analysis shows a clear upward trend leading up to the release, followed by a flattening of the trajectory after the event date. Rather than a sudden jump, the event appears to coincide with a saturation point where attention stabilizes at a high level. This pattern is consistent with anticipation-driven interest that accumulates before launch and then plateaus.", // Add placeholder if no description
      " In the placebo test, the estimated effect at the true event date lies close to the center of the placebo distribution. Effects of similar magnitude frequently occur under random date assignments, indicating that the observed change is not statistically distinctive."  // Add placeholder if no description
      ]
    },
    {
      name: "Star Wars Battlefront II",
      date: "2017-11-01",
      image: "/assets/img/starwars.jpeg",
      description: " Taken together, the analyses suggest that the release of Star Wars Battlefront II does not register as a strong or distinct attention shock in the dataset. Despite the franchise’s prominence, the event blends into ongoing platform dynamics, producing at most a modest and statistically unremarkable signal rather than a clear digital rupture.",
      plotJson: "/assets/js/star_wars_battlefront_ii.json", // Plotly JSON for the first plot
      plotlyDescription: " I observe that the treated topic closely follows the control category both before and after the release date, with strong shared weekly oscillations. There is no clear or isolated spike at the event date, nor a sustained post-event divergence. Any small deviations around the release appear comparable to regular fluctuations observed elsewhere in the series, suggesting a weak or diffuse treatment effect.",
      plotPaths: [
        "/assets/plots/star_wars_battlefront_ii_ITS.png", // Static image for the second plot
        "/assets/plots/star_wars_battlefront_ii_Placebo.png"  // Static image for the third plot
      ],
      plotDescriptions: [
      " The ITS analysis shows a modest level increase at the event date, followed by a gradual downward trend. The change is smooth rather than abrupt, indicating the absence of a sharp structural break. This pattern is consistent with a release that generates moderate attention but does not fundamentally alter the trajectory of activity.", // Add placeholder if no description
      " The placebo distribution places the estimated effect at the actual event date near the center of the distribution. Effects of similar magnitude occur frequently under random date assignments, providing little evidence that the observed change is exceptional."  // Add placeholder if no description
      ]
    },
    {
      name: "Zelda: Breath of the Wild",
      date: "2017-03-03",
      image: "/assets/img/zelda.webp",
      description: " Across all three analyses, The Legend of Zelda: Breath of the Wild emerges as a textbook example of a high-impact game release. The strong DiD divergence, the sharp ITS discontinuity, and the extreme placebo result consistently point to an intense but transient surge in YouTube attention, leaving a clear and well-localized digital footprint centered on the release date.",
      plotJson: "/assets/js/zelda_breath_of_the_wild.json", // Plotly JSON for the first plot
      plotlyDescription: " I observe a very sharp and immediate spike in the treated topic exactly at the release date, clearly separating it from the control category. Prior to the event, the treated series remains at a much lower baseline, while the release produces a sudden and substantial divergence. After the peak, attention decays gradually, eventually converging back toward the control trajectory. This pattern indicates a strong, release-driven attention shock.",
      plotPaths: [
        "/assets/plots/zelda_breath_of_the_wild_ITS.png", // Static image for the second plot
        "/assets/plots/zelda_breath_of_the_wild_Placebo.png"  // Static image for the third plot
      ],
      plotDescriptions: [
      " The ITS analysis shows a pronounced level jump at the event date, interrupting a gently increasing pre-release trend. The post-event period is characterized by a clear downward slope, reflecting a rapid but smooth decay of attention after the initial surge. The magnitude and timing of the discontinuity provide strong evidence of an event-centered effect.", // Add placeholder if no description
      " The placebo test places the estimated effect for the actual release far beyond the extreme right tail of the distribution. Comparable effects are essentially absent under random date assignments, making it highly unlikely that the observed spike is due to chance."  // Add placeholder if no description
      ]
    },
    {
      name: "Worlds LoL 2016",
      date: "2016-10-29",
      image: "/assets/img/lol.jpg",
      description: " Taken together, the analyses indicate that the League of Legends World Championship does not manifest as a single, well-defined attention shock at its start date. Instead, its digital footprint appears temporally diffuse, with attention building and peaking later in the competition. This highlights a limitation of single-date interventions for multi-stage events, where impact is distributed across time rather than concentrated at one moment.",
      plotJson: "/assets/js/worlds_lol.json", // Plotly JSON for the first plot
      plotlyDescription: " I observe that the treated topic and the control category follow similar patterns around the event date, with no clear or immediate divergence at the start of the tournament. A large spike appears later in the period, but it is temporally displaced from the designated intervention point and therefore cannot be attributed to the event date used in the analysis. This weakens the interpretation of a direct treatment effect at the chosen breakpoint.",
      plotPaths: [
        "/assets/plots/worlds_lol_ITS.png", // Static image for the second plot
        "/assets/plots/worlds_lol_Placebo.png"  // Static image for the third plot
      ],
      plotDescriptions: [
      " The ITS analysis shows a smooth and gradual upward trend that continues through the event date, without a clear level shift or change in slope. The event does not coincide with a structural break; instead, activity increases progressively over time. The later surge in counts likely reflects downstream stages of the tournament rather than its opening moment.", // Add placeholder if no description
      " In the placebo test, the estimated effect at the actual event date lies well within the central mass of the placebo distribution. Similar effects are common under random date assignments, suggesting that the observed change is not statistically distinctive."  // Add placeholder if no description
      ]
    },
    {
      name: "GTA V Release",
      date: "2013-09-17",
      image: "/assets/img/gta.jpg",
      description: " Across all three analyses, the release of GTA V stands out as one of the most extreme attention shocks in the dataset. The convergence of a dramatic DiD spike, a sharp ITS discontinuity, and an extreme placebo result indicates a highly salient but transient digital event. An intense burst of interest driven by release-day dynamics, followed by a predictable decay.",
      plotJson: "/assets/js/gta_release.json", // Plotly JSON for the first plot
      plotlyDescription: "I observe an immediate and very large spike in the treated topic exactly at the release date, clearly separating it from the control category. Prior to the event, the treated series evolves at a lower level than the control, but the release produces a sudden and overwhelming divergence. After the peak, attention decays gradually, eventually converging back toward the control trajectory. This pattern points to a strong, release-driven shock.",
      plotPaths: [
        "/assets/plots/gta_release_ITS.png", // Static image for the second plot
        "/assets/plots/gta_release_Placebo.png"  // Static image for the third plot
      ],
      plotDescriptions: [
      " The ITS analysis shows a pronounced level jump at the event date, interrupting a steadily increasing pre-release trend. The post-event period is characterized by a clear downward slope, indicating a gradual loss of attention after the initial surge. The magnitude and timing of the discontinuity strongly support an event-centered interpretation.", // Add placeholder if no description
      " The placebo test places the estimated effect of the actual release far beyond the extreme right tail of the distribution. No comparable effects are observed under random date assignments, making it highly unlikely that this spike is due to chance."  // Add placeholder if no description
      ]
    }
  ];
  
  events.forEach((event, index) => {
    const cardDiv = document.createElement('div');
    cardDiv.className = 'event-card';
    cardDiv.innerHTML = `
      <img src="${event.image}" alt="${event.name}">
      <div class="event-date">${event.date}</div>
    `;

    cardDiv.addEventListener('click', async () => {
      if (eventDetails.style.display === 'block') {
        eventDetails.style.display = 'none';
      } else {
        eventDetails.style.display = 'block';
    
        // Plotly plot and description
        const plotlyHTML = `
          <div class="plot-and-description">
            <div class="plot-container">
              <div id="plotly-plot"></div>
            </div>
            <div class="description-bubble">
              <p class="plotly-description">${event.plotlyDescription || ''}</p>
            </div>
          </div>
        `;
    
        // Static plots and descriptions
        const plotsHTML = event.plotPaths.map((path, index) => `
          <div class="plot-and-description">
            <div class="plot-container">
              <img src="${path}" alt="Plot ${index + 1}" class="plot-image">
            </div>
            <div class="description-bubble">
              <p class="plot-description">${event.plotDescriptions ? event.plotDescriptions[index] : ''}</p>
            </div>
          </div>
        `).join('');
    
        eventDetails.innerHTML = `
          <h2>${event.name} <span style="font-size: 16px; color: #aaa;">(${event.date})</span></h2>
          <p>${event.description}</p>
          <div class="plots-and-descriptions">
            ${plotlyHTML}
            ${plotsHTML}
          </div>
        `;
    
        try {
          const response = await fetch(event.plotJson);
          if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
          const plotData = await response.json();
          Plotly.newPlot('plotly-plot', plotData.plotly_data.data, plotData.plotly_data.layout);
        } catch (error) {
          console.error('Error loading the Plotly JSON:', error);
          document.getElementById('plotly-plot').innerHTML = '<p>Error loading plot data. Please try again later.</p>';
        }
      }
    });


    sliderContainer.appendChild(cardDiv);
  });
});
